<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Theo d√µi s·ªë l∆∞·ª£ng thi·∫øt b·ªã</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 30px;
    }

    h2 {
      margin-bottom: 20px;
    }

    #searchInput {
      padding: 8px 12px;
      margin-bottom: 16px;
      width: 300px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: center;
    }

    th {
      background-color: #f2f2f2;
    }

    .status.ok {
      color: green;
      font-weight: bold;
    }

    .status.warning {
      color: orange;
      font-weight: bold;
    }

    .status.danger {
      color: red;
      font-weight: bold;
    }

    button {
      padding: 8px 16px;
      background-color: #007B9E;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #005f78;
    }
  </style>
</head>
<body>

<h2>Theo d√µi s·ªë l∆∞·ª£ng thi·∫øt b·ªã trong kho trung t√¢m</h2>

<input type="text" id="searchInput" placeholder="üîç T√¨m thi·∫øt b·ªã...">

<table id="deviceTable">
  <thead>
    <tr>
      <th>T√™n thi·∫øt b·ªã</th>
      <th>S·ªë l∆∞·ª£ng trong kho</th>
      <th>Ng∆∞·ª°ng t·ªëi thi·ªÉu</th>
      <th>ƒêi·ªÅu ch·ªânh</th>
      <th>Tr·∫°ng th√°i t·ªìn kho</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>M√°y th·ªü PHILIPS</td>
      <td>12</td>
      <td>5</td>
      <td><input type="number" class="adjust-input" value="0"></td>
      <td></td>
    </tr>
    <tr>
      <td>B∆°m ti√™m ƒëi·ªán</td>
      <td>3</td>
      <td>5</td>
      <td><input type="number" class="adjust-input" value="0"></td>
      <td></td>
    </tr>
    <tr>
      <td>Monitor theo d√µi</td>
      <td>0</td>
      <td>2</td>
      <td><input type="number" class="adjust-input" value="0"></td>
      <td></td>
    </tr>
  </tbody>
</table>

<br>
<button onclick="applyAdjustment()">üíæ L∆∞u ƒëi·ªÅu ch·ªânh</button>

<button onclick="exportToExcel()">üì• Xu·∫•t Excel</button>

<script>
  // T√¨m ki·∫øm theo t√™n thi·∫øt b·ªã
  document.getElementById("searchInput").addEventListener("keyup", function () {
    const filter = this.value.toUpperCase();
    const rows = document.querySelectorAll("#deviceTable tbody tr");

    rows.forEach(row => {
      const cell = row.querySelector("td");
      if (cell && cell.textContent.toUpperCase().indexOf(filter) > -1) {
        row.style.display = "";
      } else {
        row.style.display = "none";
      }
    });
  });

  // Xu·∫•t Excel
  function exportToExcel() {
    const table = document.getElementById("deviceTable");
    const wb = XLSX.utils.table_to_book(table, { sheet: "Thi·∫øt b·ªã" });
    XLSX.writeFile(wb, "thiet_bi_ton_kho.xlsx");
  }
</script>

<script>
    // T·ª± ƒë·ªông t√≠nh tr·∫°ng th√°i t·ªìn kho theo s·ªë l∆∞·ª£ng
  window.addEventListener("DOMContentLoaded", () => {
    const rows = document.querySelectorAll("#deviceTable tbody tr");

    rows.forEach(row => {
      const quantity = parseInt(row.cells[1].textContent);
      const threshold = parseInt(row.cells[2].textContent);
      const statusCell = row.cells[3];

      if (quantity === 0) {
        statusCell.textContent = "‚õî H·∫øt h√†ng";
        statusCell.className = "status out ";
      } else if (quantity <= threshold) {
        statusCell.textContent = "‚ö†Ô∏è S·∫Øp h·∫øt";
        statusCell.className = "status low";
      } else {
        statusCell.textContent = "‚úÖ C√≤n nhi·ªÅu";
        statusCell.className = "status ok";
      }
    });
  });
</script>

</body>
</html>
